<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>资产收集</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        async function collectAssets() {
            const target = document.getElementById("targetInput").value;
            if (!target) {
                alert("请输入目标");
                return;
            }

            const response = await fetch("{{ url_for('asset.collect') }}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ target })
            });

            const result = await response.json();

            const resultDiv = document.getElementById("result");
            if (result.status === "success") {
                resultDiv.innerHTML = `
                    <h3>资产收集成功</h3>
                    <pre>${JSON.stringify(result.assets, null, 2)}</pre>
                    <h4>CSV 输出:</h4>
                    <pre>${result.csv}</pre>
                `;
            } else {
                resultDiv.innerHTML = `<p style="color:red;">${result.message}</p>`;
            }
        }
    </script>
</head>
<body>
    <div class="dashboard-container">
        <header class="topbar">
            <div class="system-title">资产收集</div>
        </header>
        <main class="main-panel">
            <h2>请输入目标（IP 或域名）</h2>
            <input type="text" id="targetInput" placeholder="如 example.com 或 1.1.1.1" />
            <button onclick="collectAssets()">开始收集</button>
            <div id="result" style="margin-top:20px;"></div>
        </main>
    </div>
</body>
</html>
